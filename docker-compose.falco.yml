version: "3.9"
services:
  falco:
    image: falcosecurity/falco:0.38.1
    privileged: true
    volumes:
      - /var/run/docker.sock:/host/var/run/docker.sock
      - /proc:/host/proc:ro
      - /boot:/host/boot:ro
      - /lib/modules:/host/lib/modules:ro
      - ./falco-redis-rule.yaml:/etc/falco/falco_rules.d/redis.yaml:ro
    environment:
      - FALCO_JSON_OUTPUT=true
      - FALCO_WEBHOOK_SLACK_URL=${SLACK_ALERT_WEBHOOK}
    command: >
      falco --disable-cri-async  # reduce noise in Docker Desktop
